"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[584],{2056:(e,t,r)=>{r.d(t,{O:()=>s,b:()=>n});let n={save:e=>{try{localStorage.setItem("spellingbee_user_preferences",JSON.stringify({...e,lastUpdated:new Date().toISOString()})),localStorage.setItem("spellingbee_user_info",JSON.stringify({userId:e.userId,userName:e.userName}))}catch(e){console.error("Failed to save user preferences:",e)}},load:()=>{try{let e=localStorage.getItem("spellingbee_user_preferences");if(!e)return null;let t=JSON.parse(e),r=localStorage.getItem("spellingbee_user_info"),n="",s="";if(r){let e=JSON.parse(r);n=e.userId,s=e.userName}return{...t,userId:n,userName:s,lastUpdated:new Date(t.lastUpdated)}}catch(e){return console.error("Failed to load user preferences:",e),null}},clear:()=>{try{localStorage.removeItem("spellingbee_user_preferences")}catch(e){console.error("Failed to clear user preferences:",e)}}},s={save:(e,t)=>{try{let r=localStorage.getItem("spellingbee_user_info"),n="";r&&(n=JSON.parse(r).userId);let i=new Date,a={...e,userId:n,id:"game_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),completedAt:i,created_at:i.toISOString(),pendingSync:!t},o=s.loadAll(),l=[a,...o].slice(0,100);return localStorage.setItem("spellingbee_game_history",JSON.stringify(l)),a}catch(e){throw console.error("Failed to save game result:",e),e}},syncPendingRecords:async(e,t)=>{if(!navigator.onLine)return;let r=s.loadAll(),n=r.filter(e=>e.pendingSync);for(let r of n){let{data:n,error:s}=await e.from(t).select("id").eq("id",r.id);if(!s&&(!n||0===n.length)){let{error:n}=await e.from(t).insert([{...r,pendingSync:void 0}]);n||(r.pendingSync=!1)}}let i=r.map(e=>n.find(t=>t.id===e.id)?{...e,pendingSync:!1}:e);localStorage.setItem("spellingbee_game_history",JSON.stringify(i))},loadAll:()=>{try{let e=localStorage.getItem("spellingbee_game_history");if(!e)return[];return JSON.parse(e).map(e=>({...e,completedAt:new Date(e.completedAt)}))}catch(e){return console.error("Failed to load game history:",e),[]}},mergeWithRemote:e=>{let t=s.loadAll(),r=[...e];for(let e of t)r.find(t=>t.id===e.id)||r.push(e);return r.map(e=>({...e,created_at:"string"==typeof e.created_at?e.created_at:e.completedAt instanceof Date?e.completedAt.toISOString():"string"==typeof e.completedAt?e.completedAt:new Date().toISOString()}))},clear:()=>{try{localStorage.removeItem("spellingbee_game_history")}catch(e){console.error("Failed to clear game history:",e)}}}},2745:(e,t,r)=>{r.d(t,{al:()=>s});var n=r(2115);let s=()=>{let[e,t]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{let e=()=>{t(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),e}},3970:(e,t,r)=>{let n;r.d(t,{N:()=>n});var s=r(2354);try{let e="https://jtpzzbognaeitsffarcd.supabase.co",t="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imp0cHp6Ym9nbmFlaXRzZmZhcmNkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ3ODUzMTQsImV4cCI6MjA3MDM2MTMxNH0.EKnCEKxKKLLs9iWkHdBHdyWeyrQsHa6IU02NTNGatao";if(!e||!t)throw Error("Supabase URL or Anon Key is missing. Check your environment variables.");n=(0,s.UU)(e,t),console.log("[Supabase] Client initialized:",e)}catch(e){console.error("[Supabase] Initialization error:",e)}},7488:(e,t,r)=>{r.d(t,{CG:()=>n,cZ:()=>i,uq:()=>s});let n={USERS:"game_players",RECORDS:"game_history",APPS:"game_apps"},s={NAME:"spellingbee",ID:"ea0f66f6-1998-4b7e-b29f-93191ef2ed8e"},i={USERS:{ID:"id",USERNAME:"username"},RECORDS:{ID:"id",PLAYER_ID:"player_id",SCORE:"score",ACHIEVEMENT:"achievement",GAME_DURATION:"game_duration",PLAYER_LEVEL:"player_level",GAME_SETTINGS:"game_settings"},GAME_APPS:{ID:"id",GAME_SETTINGS:"game_settings"}}},8258:(e,t,r)=>{r.d(t,{e:()=>m});var n=r(5453),s=r(2056),i=r(3970),a=r(7488);async function o(e){console.log("[Supabase] createUser called with:",e);let{data:t,error:r}=await i.N.from(a.CG.USERS).insert([{username:e}]).select();if(r)throw console.error("[Supabase] createUser error:",r),r;return console.log("[Supabase] createUser response:",t),null==t?void 0:t[0]}async function l(e){console.log("[Supabase] getUserByUsername called with:",e);let{data:t,error:r}=await i.N.from(a.CG.USERS).select("*").eq(a.cZ.USERS.USERNAME,e);if(r)throw console.error("[Supabase] getUserByUsername error:",r),r;return console.log("[Supabase] getUserByUsername response:",t),t&&t.length>0?t[0]:null}async function c(e){let{player_id:t,game_id:r,score:n,achievement:s,game_duration:o,challenge_mode:l,player_level:c,game_settings:u}=e;console.log("[Supabase] createGameRecord called with:",{player_id:t,game_id:r,score:n,achievement:s,game_duration:o,challenge_mode:l,player_level:c,game_settings:u});let{data:m,error:g}=await i.N.from(a.CG.RECORDS).insert([{player_id:t,game_id:r,score:n,achievement:s,game_duration:o,challenge_mode:l,player_level:c,game_settings:u}]).select();if(g)throw console.error("[Supabase] createGameRecord error:",g),g;return console.log("[Supabase] createGameRecord response:",m),null==m?void 0:m[0]}let u={username:"",difficulty:"easy",numberOfQuestions:10,timerPerQuestion:20,questionType:"input",categories:["all"],timerEnabled:!0,questionsEnabled:!0,minCorrectAnswers:0,maxCorrectAnswers:5,correctAnswersEnabled:!1,minIncorrectAnswers:0,maxIncorrectAnswers:5,incorrectAnswersEnabled:!1,overallTimerEnabled:!1,overallTimerDuration:180,challengeMode:void 0},m=(0,n.v)((e,t)=>({_gameRecordSaved:!1,settings:u,questions:[],currentQuestionIndex:0,timeRemaining:u.timerPerQuestion,isQuizActive:!1,isQuizCompleted:!1,currentStreak:0,bestStreak:0,correctAnswersCount:0,incorrectAnswersCount:0,quizStartTime:null,overallTimeRemaining:u.overallTimerDuration,overallTimerActive:!1,updateSettings:t=>{e(e=>({settings:{...e.settings,...t}}))},setQuestions:t=>{e({questions:t,currentQuestionIndex:0})},startQuiz:()=>{e(e=>({isQuizActive:!0,isQuizCompleted:!1,currentQuestionIndex:0,timeRemaining:e.settings.timerEnabled?e.settings.timerPerQuestion:0,correctAnswersCount:0,incorrectAnswersCount:0,quizStartTime:Date.now(),overallTimeRemaining:e.settings.overallTimerEnabled?e.settings.overallTimerDuration:0,overallTimerActive:e.settings.overallTimerEnabled,_gameRecordSaved:!1}))},nextQuestion:()=>{e(e=>{let t=e.currentQuestionIndex+1,r=t>=e.questions.length,n=e.settings.correctAnswersEnabled&&e.correctAnswersCount>=e.settings.maxCorrectAnswers,s=e.settings.incorrectAnswersEnabled&&e.incorrectAnswersCount>=e.settings.maxIncorrectAnswers,i=r||n||s;return{currentQuestionIndex:t,timeRemaining:i?0:e.settings.timerEnabled?e.settings.timerPerQuestion:0,isQuizCompleted:i,isQuizActive:!i}})},submitAnswer:t=>{e(e=>{let r=e.currentQuestionIndex,n=[...e.questions],s=n[r],i=!1;if(s){if("input"===e.settings.questionType)i="string"==typeof t&&t.trim().toLowerCase()===s.answer.trim().toLowerCase(),s.userAnswer=t;else if("multiple-choice"===e.settings.questionType&&s.options){let e="number"==typeof t?t:parseInt(t);i=s.options[e]===s.answer,s.userAnswer=s.options[e]}s.isCorrect=i,n[r]=s}return{questions:n,correctAnswersCount:i?e.correctAnswersCount+1:e.correctAnswersCount,incorrectAnswersCount:i?e.incorrectAnswersCount:e.incorrectAnswersCount+1}})},setTimeRemaining:t=>{e({timeRemaining:t})},setOverallTimeRemaining:t=>{e({overallTimeRemaining:t})},completeQuiz:async()=>{e({isQuizActive:!1,isQuizCompleted:!0,overallTimerActive:!1})},resetQuiz:()=>{e({questions:[],currentQuestionIndex:0,timeRemaining:t().settings.timerEnabled?t().settings.timerPerQuestion:0,isQuizActive:!1,isQuizCompleted:!1,currentStreak:0,bestStreak:0,correctAnswersCount:0,incorrectAnswersCount:0,quizStartTime:null,overallTimeRemaining:t().settings.overallTimerDuration,overallTimerActive:!1})},retryQuiz:r=>{e({questions:r,currentQuestionIndex:0,timeRemaining:t().settings.timerEnabled?t().settings.timerPerQuestion:0,isQuizActive:!1,isQuizCompleted:!1,currentStreak:0,correctAnswersCount:0,incorrectAnswersCount:0,quizStartTime:null,overallTimeRemaining:t().settings.overallTimerDuration,overallTimerActive:!1,_gameRecordSaved:!1})},loadUserPreferences:()=>{s.b.load()&&e(()=>({}))},saveUserPreferences:()=>{let e=t(),r="";{let e=localStorage.getItem("spellingbee_quiz_user");if(e)try{r=JSON.parse(e).userId||""}catch(e){}}s.b.save({userId:r,userName:e.settings.username,settings:e.settings,lastUpdated:new Date})},saveGameResult:async()=>{let r=t();if(!r.isQuizCompleted||0===r.questions.length||t()._gameRecordSaved)return null;let n=r.questions.filter(e=>e.isCorrect).length,i=r.questions.length,u=Math.round(n/i*100),m=r.questions.reduce((e,t)=>e+(t.timeSpent||0),0),g=r.quizStartTime?Math.round((Date.now()-r.quizStartTime)/1e3):m,d="",p=r.settings.username;{let e=localStorage.getItem("spellingbee_quiz_user");if(e)try{let t=JSON.parse(e);d=t.userId||"",p=t.userName||p}catch(e){}}if(navigator.onLine&&p)try{let e=await l(p);e||(e=await o(p)),e&&e.id&&(d=e.id,localStorage.setItem("spellingbee_quiz_user",JSON.stringify({userId:d,userName:p}))),await c({player_id:d,game_id:a.uq.ID,score:u,achievement:"",challenge_mode:r.settings.challengeMode||"none",game_duration:g,player_level:r.settings.difficulty,game_settings:r.settings})}catch(e){console.error("Supabase save error:",e)}let S=s.O.save({settings:r.settings,questions:r.questions.map(e=>{var t;return{question:e.question,correctAnswer:e.answer.toString(),userAnswer:(null==(t=e.userAnswer)?void 0:t.toString())||"",isCorrect:e.isCorrect||!1,timeSpent:e.timeSpent||0}}),totalQuestions:i,correctAnswers:n,incorrectAnswers:r.incorrectAnswersCount,score:u,timeSpent:m,quizDuration:g,averageTimePerQuestion:i>0?Math.round(m/i):0,created_at:new Date().toISOString()},!navigator.onLine);return e({_gameRecordSaved:!0}),S},clearUserData:()=>{s.b.clear(),s.O.clear(),e({settings:u,questions:[],currentQuestionIndex:0})}}))}}]);