(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[429],{355:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>g});var a=r(5155),s=r(2115),i=r(3970),n=r(7488),l=r(5695),o=r(2056),c=r(8258),d=r(2745),x=r(4223);let u=e=>{let{username:t}=e;return(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsxs)("h1",{className:"text-4xl font-bold text-gray-800 dark:text-white mb-2",children:["\uD83C\uDFC6 ",t?"".concat(t," Game History"):"Game History"]}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-300",children:"Review your quiz performance and track your progress"})]})},m=()=>{let e=(0,l.useRouter)();return(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8 text-center",children:[(0,a.jsx)("div",{className:"text-6xl mb-4",children:"\uD83D\uDCCA"}),(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"No Game History Found"}),(0,a.jsx)("p",{className:"text-gray-500 dark:text-gray-400 mb-6",children:"Start playing quizzes to see your history here!"}),(0,a.jsx)(x.T,{variant:"primary",size:"lg",onClick:()=>e.push("/"),icon:"\uD83C\uDFAF",children:"Start a Quiz"})]})};function g(){let e=(0,l.useRouter)(),t=(0,d.al)(),{settings:r}=(0,c.e)(),[g,h]=(0,s.useState)([]),[p,y]=(0,s.useState)("date"),[b,f]=(0,s.useState)(!0);(0,s.useEffect)(()=>{!async function(){f(!0);try{let e="";{let t=localStorage.getItem("spellingbee_quiz_user");if(t)try{e=JSON.parse(t).userId||""}catch(e){}}if(!e)return void f(!1);if(!navigator.onLine){let t=o.O.loadAll().filter(t=>t.userId===e);h(t),f(!1);return}let{data:t,error:r}=await i.N.from(n.CG.RECORDS).select("*").eq("player_id",e);if(r)throw r;let a=(t||[]).map(e=>{var t,r;let a=e.settings;if(!a&&e.game_settings)try{a="string"==typeof e.game_settings?JSON.parse(e.game_settings):e.game_settings}catch(e){a={}}let s=Array.isArray(e.questions)?e.questions.map(e=>{var t,r,a,s,i;return{question:null!=(t=e.question)?t:"",correctAnswer:null!=(r=e.correctAnswer)?r:"",userAnswer:null!=(a=e.userAnswer)?a:"",isCorrect:null!=(s=e.isCorrect)&&s,timeSpent:null!=(i=e.timeSpent)?i:0}}):[];return{id:null!=(t=e.id)?t:"",userId:null!=(r=e.player_id)?r:"",settings:a,questions:s,totalQuestions:"number"==typeof e.totalQuestions?e.totalQuestions:0,correctAnswers:"number"==typeof e.correctAnswers?e.correctAnswers:0,incorrectAnswers:"number"==typeof e.incorrectAnswers?e.incorrectAnswers:0,score:"number"==typeof e.score?e.score:0,completedAt:e.completedAt?new Date(e.completedAt):e.created_at?new Date(e.created_at):new Date,created_at:e.created_at?new Date(e.created_at).toISOString():new Date().toISOString(),timeSpent:"number"==typeof e.timeSpent?e.timeSpent:0,quizDuration:"number"==typeof e.quizDuration?e.quizDuration:0,averageTimePerQuestion:"number"==typeof e.averageTimePerQuestion?e.averageTimePerQuestion:0,pendingSync:!1}}),s=o.O.mergeWithRemote(a).filter(t=>t.userId===e);localStorage.setItem("spellingbee_game_history",JSON.stringify(s)),h(s)}catch(e){console.error("Failed to fetch/merge game history:",e)}finally{f(!1)}}()},[]);let v=[...g].sort((e,t)=>{var r,a;return"date"!==p?t.score-e.score:new Date(null!=(r=t.created_at)?r:t.completedAt).getTime()-new Date(null!=(a=e.created_at)?a:e.completedAt).getTime()});return b?(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 dark:from-blue-900 dark:to-purple-900 flex items-center justify-center",children:(0,a.jsx)("div",{className:"text-xl font-semibold text-gray-700 dark:text-gray-300",children:"Loading history..."})}):(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 dark:from-blue-900 dark:to-purple-900",children:(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8 ".concat(t?"max-w-full":"max-w-6xl"),children:[(0,a.jsx)(u,{username:r.username}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-6 ".concat(t?"space-y-4":"flex justify-between items-center"),children:[(0,a.jsx)("div",{className:"flex gap-4 ".concat(t?"flex-col":"items-center"),children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Sort by:"}),(0,a.jsxs)("select",{value:p,onChange:e=>y(e.target.value),className:"px-3 py-1 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm",children:[(0,a.jsx)("option",{value:"date",children:"Date"}),(0,a.jsx)("option",{value:"score",children:"Score"})]})]})}),(0,a.jsx)("div",{className:"flex gap-2 ".concat(t?"justify-center":""),children:(0,a.jsx)(x.T,{variant:"secondary",size:"sm",onClick:()=>{if(confirm("Are you sure you want to clear all game history? This action cannot be undone."))try{o.O.clear(),h([])}catch(e){console.error("Failed to clear history:",e)}},icon:"\uD83D\uDDD1️",children:"Clear All History"})})]}),0===v.length?(0,a.jsx)(m,{}):(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden",children:[(0,a.jsx)("div",{className:"bg-gray-50 dark:bg-gray-700 px-6 py-4 border-b border-gray-200 dark:border-gray-600",children:(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white",children:"Quiz History"})}),(0,a.jsx)("div",{className:"".concat(t?"overflow-x-auto":""),children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Date"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Score"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Year Level"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Game Settings"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Performance"})]})}),(0,a.jsx)("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-600",children:v.map(e=>{var t,r,s;return(0,a.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[(0,a.jsx)("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:new Date(e.created_at?new Date(e.created_at):e.completedAt).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}),(0,a.jsx)("td",{className:"px-4 py-4 whitespace-nowrap",children:(0,a.jsxs)("span",{className:"text-lg font-bold ".concat((s=e.score)>=90?"text-green-600 dark:text-green-400":s>=70?"text-yellow-600 dark:text-yellow-400":"text-red-600 dark:text-red-400"),children:[e.score,"%"]})}),(0,a.jsx)("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:e.settings.difficulty.charAt(0).toUpperCase()+e.settings.difficulty.slice(1)}),(0,a.jsx)("td",{className:"px-4 py-4 text-sm text-gray-900 dark:text-white",children:(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{children:["\uD83D\uDCDD ",(null==(t=e.settings.questionType)?void 0:t.charAt(0).toUpperCase())+(null==(r=e.settings.questionType)?void 0:r.slice(1))||"Multiple Choice"]}),"numberTypes"in e.settings&&Array.isArray(e.settings.numberTypes)&&(0,a.jsxs)("div",{children:["\uD83D\uDD22 ",e.settings.numberTypes.map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(", ")]}),"mathOperations"in e.settings&&Array.isArray(e.settings.mathOperations)&&(0,a.jsxs)("div",{children:["➕ ",e.settings.mathOperations.map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(", ")]})]})}),(0,a.jsx)("td",{className:"px-4 py-4 text-sm text-gray-900 dark:text-white",children:(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{children:[e.correctAnswers,"/",e.totalQuestions," correct"]}),e.timeSpent>0&&(0,a.jsxs)("div",{children:["⏱️ ",(e=>{if(e<60)return"".concat(Math.round(e),"s");let t=Math.floor(e/60),r=Math.round(e%60);return"".concat(t,"m ").concat(r,"s")})(e.timeSpent)]})]})})]},e.id)})})]})})]}),(0,a.jsx)("div",{className:"mt-8 text-center",children:(0,a.jsx)(x.T,{variant:"primary",size:"lg",onClick:()=>e.push("/"),icon:"\uD83C\uDFE0",children:"Back to Home"})})]})})}},1068:(e,t,r)=>{Promise.resolve().then(r.bind(r,355))},4223:(e,t,r)=>{"use strict";r.d(t,{T:()=>s});var a=r(5155);r(2115);let s=e=>{let{variant:t="primary",size:r="md",fullWidth:s=!1,icon:i,children:n,onClick:l,disabled:o=!1,className:c=""}=e;return(0,a.jsxs)("button",{onClick:l,disabled:o,className:"".concat("font-semibold rounded-xl transition-all duration-200 active:scale-95 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 cursor-pointer"," ").concat({sm:"min-h-[44px] px-4 py-2 text-sm",md:"min-h-[56px] px-6 py-3 text-base",lg:"min-h-[72px] px-8 py-4 text-lg"}[r]," ").concat({primary:"bg-gradient-to-r from-blue-500 to-purple-600 dark:from-blue-600 dark:to-purple-700 text-white shadow-lg hover:shadow-xl hover:from-blue-600 hover:to-purple-700 dark:hover:from-blue-700 dark:hover:to-purple-800 hover:transform hover:scale-105",secondary:"bg-gray-100 dark:bg-slate-700 text-gray-800 dark:text-gray-200 border border-gray-300 dark:border-slate-600 hover:bg-gray-200 dark:hover:bg-slate-600 hover:transform hover:scale-105",tile:"bg-white dark:bg-slate-800 text-gray-800 dark:text-gray-200 border-2 border-gray-200 dark:border-slate-600 hover:border-gray-300 dark:hover:border-slate-500 hover:bg-gray-50 dark:hover:bg-slate-700 shadow-sm hover:transform hover:scale-105",ghost:"bg-transparent text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-slate-800 hover:transform hover:scale-105"}[t]," ").concat(s?"w-full":""," ").concat(c),children:[i&&(0,a.jsx)("span",{children:i}),(0,a.jsx)("span",{children:n})]})}}},e=>{e.O(0,[508,584,441,964,358],()=>e(e.s=1068)),_N_E=e.O()}]);